syntax = "proto3";

package product.v1;

option go_package = "/product";

import "pagination.proto";
import "values.proto";


message Product {
    int64 id                                 = 1;
    string title                             = 2;
    int64 category_id                        = 3;
    repeated string image_ids                = 4;
    repeated string video_ids                = 5;
    repeated string catalogue_ids            = 6;
    repeated string plan_ids                 = 7;
    optional string description              = 8;
    optional string features_and_accessories = 9;
    optional int64 parent_id                 = 10;
    repeated int64 children_ids              = 11;
    string deleted_at                        = 12;
}

enum ProductField {
    PRODUCT_FIELD_UNKNOWN                  = 0;
    PRODUCT_FIELD_ID                       = 1;
    PRODUCT_FIELD_TITLE                    = 2;
    PRODUCT_FIELD_CATEGORY_ID              = 3;
    PRODUCT_FIELD_IMAGE_IDS                = 4;
    PRODUCT_FIELD_VIDEO_IDS                = 5;
    PRODUCT_FIELD_CATALOGUE_IDS            = 6;
    PRODUCT_FIELD_PLAN_IDS                 = 7;
    PRODUCT_FIELD_DESCRIPTION              = 8;
    PRODUCT_FIELD_FEATURES_AND_ACCESSORIES = 9;
    PRODUCT_FIELD_PARENT_ID                = 10;
    PRODUCT_FIELD_CHILDREN_IDS             = 11;
}

message AddProductRequest {
    message Product {
        string title                             = 1;
        int64 category_id                        = 2;
        repeated string image_ids                = 3;
        repeated string video_ids                = 4;
        repeated string catalogue_ids            = 5;
        repeated string plan_ids                 = 6;
        optional string description              = 7;
        optional string features_and_accessories = 8;
    }
    Product product                                    = 1;
    map<int64, ValueWrapper> product_attributes_values = 2;
    map<int64, string> product_codes_values            = 3;
}
message AddProductResponse {
    int64 product_id = 1;
}

message AddProductInBulkRequest {
    repeated AddProductRequest requests = 1;
}
message AddProductInBulkResponse {
    message Response {
        oneof response {
            string error                           = 1;
            AddProductResponse successful_response = 2;
        }
    }
    repeated Response responses = 1;
}

message AddProductTreeRequest {
    message Parent {
        message NewParent {
            string title                                      = 1;
            int64 category_id                                 = 2;
            repeated string video_ids                         = 3;
            repeated string catalogue_ids                     = 4;
            repeated string plan_ids                          = 5;
            optional string description                       = 6;
            optional string features_and_accessories          = 7;
            map<int64, ValueWrapper> shared_attributes_values = 8;
            map<int64, string> codes_values                   = 9;
        }
        message ExistingParent {
            int64 id = 1;
        }
        oneof parent {
            NewParent new           = 1;
            ExistingParent existing = 2;
        }
    }
    message Child {
        repeated string image_ids                                  = 1;
        map<int64, ValueWrapper> distinguishable_attributes_values = 2;
    }
    Parent parent           = 1;
    repeated Child children = 2;
}
message AddProductTreeResponse {
    optional int64 parent_id    = 1;
    repeated int64 children_ids = 2;
}

message AddProductTreeInBulkRequest {
    repeated AddProductTreeRequest requests = 1;
}
message AddProductTreeInBulkResponse {
    message Response {
        oneof response {
            string error                               = 1;
            AddProductTreeResponse successful_response = 2;
        }
    }
    repeated Response responses = 1;
}

message GetProductByIdRequest {
    int64 product_id = 1;
}
message GetProductByIdResponse {
    Product product = 1;
}

message GetProductsByCategoryIdRequest {
    int64 category_id                    = 1;
    PaginationRequest pagination_request = 2;
}
message GetProductsByCategoryIdResponse {
    repeated Product products              = 1;
    PaginationResponse pagination_response = 2;
}

message GetProductsByIdListRequest {
    repeated int64 product_ids = 1;
}
message GetProductsByIdListResponse {
    repeated Product products = 1;
}

message ListProductsRequest {
    PaginationRequest pagination_request = 1;
}
message ListProductsResponse {
    repeated Product products              = 1;
    PaginationResponse pagination_response = 2;
}

message SearchProductsByTitleRequest {
    string query                         = 1;
    PaginationRequest pagination_request = 2;
}
message SearchProductsByTitleResponse {
    repeated Product products              = 1;
    PaginationResponse pagination_response = 2;
}

message UpdateProductRequest {
    int64 id                                 = 1;
    string title                             = 2;
    repeated string image_ids                = 3;
    repeated string video_ids                = 4;
    repeated string catalogue_ids            = 5;
    repeated string plan_ids                 = 6;
    optional string description              = 7;
    optional string features_and_accessories = 8;
    repeated ProductField updated_fields     = 9;
}

message UpdateProductInBulkRequest {
    repeated UpdateProductRequest requests = 1;
}
message UpdateProductInBulkResponse {
    message Response {
        oneof response {
            string error              = 1;
            int64 successful_response = 2;
        }
    }

    repeated Response responses = 1;
}

message DeleteProductRequest {
    int64 target_product_id = 1;
}
message DeleteProductResponse {
    int64 deleted_product_id = 1;
}

message DeleteProductInBulkRequest {
    repeated DeleteProductRequest requests = 1;
}
message DeleteProductInBulkResponse {
    message Response {
        oneof response {
            string error                              = 1;
            DeleteProductResponse successful_response = 2;
        }
    }
    repeated Response responses = 1;
}

message GetProductAttributesRequest {
    int64 product_id = 1;
}
message GetProductAttributesResponse {
    map<int64, ValueWrapper> attributes_values = 1;
}

message GetProductAttributesInBulkRequest {
    repeated GetProductAttributesRequest requests = 1;
}
message GetProductAttributesInBulkResponse {
    message Response {
        oneof response {
            string error                                     = 1;
            GetProductAttributesResponse successful_response = 2;
        }
    }
    repeated Response responses = 1;
}

message UpdateProductAttributesRequest {
    int64 product_id                           = 1;
    map<int64, ValueWrapper> attributes_values = 2;
}
message UpdateProductAttributesResponse {
    int64 updated_product_id = 1;
}

message UpdateProductAttributesInBulkRequest {
    repeated UpdateProductAttributesRequest requests = 1;
}
message UpdateProductAttributesInBulkResponse {
    repeated UpdateProductAttributesResponse responses = 1;
}

message GetProductCodesRequest {
    int64 product_id = 1;
}
message GetProductCodesResponse {
    map<int64, string> codes_values = 1;
}

message GetProductCodesInBulkRequest {
    repeated GetProductCodesRequest requests = 1;
}
message GetProductCodesInBulkResponse {
    message Response {
        oneof response {
            string error                                = 1;
            GetProductCodesResponse successful_response = 2;
        }
    }
    repeated Response responses = 1;
}

message UpdateProductCodesRequest {
    int64 product_id                = 1;
    map<int64, string> codes_values = 2;
}
message UpdateProductCodesResponse {
    int64 updated_product_id = 1;
}

message UpdateProductCodesInBulkRequest {
    repeated UpdateProductCodesRequest requests = 1;
}
message UpdateProductCodesInBulkResponse {
    repeated UpdateProductCodesResponse responses = 1;
}

message MoveProductToAnotherCategoryRequest {
    int64 target_product_id       = 1;
    int64 destination_category_id = 2;
}
message MoveProductToAnotherCategoryResponse {
    int64 updated_product_id = 1;
}

message MoveProductToAnotherCategoryInBulkRequest {
    repeated MoveProductToAnotherCategoryRequest requests = 1;
}
message MoveProductToAnotherCategoryInBulkResponse {
    message Response {
        oneof response {
            string error                                             = 1;
            MoveProductToAnotherCategoryResponse successful_response = 2;
        }
    }
    repeated Response responses = 1;
}

enum ProductLinkType {
    PRODUCT_LINK_TYPE_UNKNOWN           = 0;
    PRODUCT_LINK_TYPE_IS_ALTERNATIVE_OF = 1;
    PRODUCT_LINK_TYPE_IS_SOLD_WITH      = 2;
    PRODUCT_LINK_TYPE_IS_MADE_OF        = 3;
    PRODUCT_LINK_TYPE_IS_USED_IN        = 4;
}

message AddLinkBetweenProductsRequest {
    int64 source_product_id      = 1;
    int64 destination_product_id = 2;
    ProductLinkType link_type    = 3;
}
message AddLinkBetweenProductsResponse {}

message AddLinkBetweenProductsInBulkRequest {
    repeated AddLinkBetweenProductsRequest requests = 1;
}
message AddLinkBetweenProductsInBulkResponse {
    message Response {
        oneof response {
            string error                                       = 1;
            AddLinkBetweenProductsResponse successful_response = 2;
        }
    }
    repeated Response responses = 1;
}

message RemoveLinkFromProductsRequest {
    int64 source_product_id      = 1;
    int64 destination_product_id = 2;
    ProductLinkType link_type    = 3;
}
message RemoveLinkFromProductsResponse {}

message RemoveLinkFromProductsInBulkRequest {
    repeated RemoveLinkFromProductsRequest requests = 1;
}
message RemoveLinkFromProductsInBulkResponse {
    message Response {
        oneof response {
            string error                                       = 1;
            RemoveLinkFromProductsResponse successful_response = 2;
        }
    }
    repeated Response responses = 1;
}

message GetLinkedProductsByProductIdRequest {
    int64 product_id = 1;
}
message GetLinkedProductsByProductIdResponse {
    message Link {
        int64 source_product_id      = 1;
        int64 destination_product_id = 2;
        ProductLinkType link_type    = 3;
        bool is_direct               = 4;
    }
    repeated Link links = 1;
}

message GetLinkedProductsByProductIdInBulkRequest {
    repeated GetLinkedProductsByProductIdRequest requests = 1;
}
message GetLinkedProductsByProductIdInBulkResponse {
    message Response {
        oneof response {
            string error                                             = 1;
            GetLinkedProductsByProductIdResponse successful_response = 2;
        }
    }
    repeated Response responses = 1;
}

message ListArchivedProductsRequest {
    PaginationRequest pagination_request = 1;
    int64 category_id                    = 2;
}

message ListArchivedProductsResponse {
    repeated Product archived_products     = 1;
    PaginationResponse pagination_response = 2;
}

message UnarchiveProductsInBulkRequest {
    repeated int64 archived_product_ids = 1;
}

message UnarchiveProductsInBulkResponse {
    message Response {
        int64 product_id = 1;
        string error     = 2;
    }

    repeated Response responses = 1;
}
